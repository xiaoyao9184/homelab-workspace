---

- name: run
  vars:
    run_wsl: |
      ansible-playbook \
        --inventory $PWD/ansible \
        $PWD/../../../docker/container/portainer-agent/ansible-playbook.run.yml
  environment:
    PATH: "{{ ansible_env.PATH }}:{{ env_path | default('',true) }}"
  hosts: docker
  tasks: 

    - name: set ws_dir
      include_tasks: "{{ playbook_dir }}/../../../.seed/ansible-tasks/ws-dir.set.yml"

    - name: run container
      community.docker.docker_container:
        detach: true
        ports:
          - "9001:9001"
        hostname: portainer-agent
        name: portainer-agent
        restart_policy: always
        volumes:
          - /var/run/docker.sock:/var/run/docker.sock
          - /var/lib/docker/volumes:/var/lib/docker/volumes 
        image: portainer/agent:latest
